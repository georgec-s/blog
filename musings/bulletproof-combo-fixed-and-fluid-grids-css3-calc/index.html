<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>Bulletproof Combo Fixed and Fluid Grids with CSS3 Calc | Snugug</title> <link rel="icon" href="/images/favicon.png"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="google-site-verification" content="zIeV2B7zZKCtEFP-6vV8rKk0ocpbp035v_g3IRn12Jo"> <style type="text/css">article,header,main{display:block}.article--title,body{text-rendering:optimizeLegibility}.article--title{word-wrap:break-word}article,body,div,h1,header,html,iframe,main,p{background:0 0;border:0;font-size:100%;margin:0;outline:0;padding:0;vertical-align:baseline}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;box-sizing:border-box}body{line-height:1;font-weight:400;background:#f8f7f2;color:#2c2a21;-webkit-font-feature-settings:"liga","dlig";-ms-font-feature-settings:"liga","dlig";-o-font-feature-settings:"liga","dlig";font-feature-settings:"liga","dlig"}*,:after,:before{box-sizing:inherit}.article--content{padding:1.21353em 1.61803em}:root{font-size:1.2em;font-family:aller,'Lucida Grande','Lucida Sans Unicode','Lucida Sans',Geneva,Verdana,sans-serif}body *+*{margin-top:1rem}.base p{line-height:1.6;letter-spacing:-.004rem}.article--heading{width:100vw;padding:2rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;z-index:-1;background-color:#c20030;background:-webkit-linear-gradient(bottom,rgba(194,0,48,0) 10%,rgba(194,0,48,.05) 10%,rgba(194,0,48,.05) 20%,rgba(194,0,48,.1) 20%,rgba(194,0,48,.1) 30%,rgba(194,0,48,.15) 30%,rgba(194,0,48,.15) 40%,rgba(194,0,48,.2) 40%,rgba(194,0,48,.2) 50%,rgba(194,0,48,.3) 50%,rgba(194,0,48,.3) 60%,rgba(194,0,48,.4) 60%,rgba(194,0,48,.4) 70%,rgba(194,0,48,.5) 70%,rgba(194,0,48,.5) 80%,rgba(194,0,48,.6) 80%,rgba(194,0,48,.6) 90%,rgba(194,0,48,.8) 90%),-webkit-linear-gradient(right,rgba(194,0,48,0) 10%,rgba(194,0,48,.05) 10%,rgba(194,0,48,.05) 20%,rgba(194,0,48,.1) 20%,rgba(194,0,48,.1) 30%,rgba(194,0,48,.15) 30%,rgba(194,0,48,.15) 40%,rgba(194,0,48,.2) 40%,rgba(194,0,48,.2) 50%,rgba(194,0,48,.3) 50%,rgba(194,0,48,.3) 60%,rgba(194,0,48,.4) 60%,rgba(194,0,48,.4) 70%,rgba(194,0,48,.5) 70%,rgba(194,0,48,.5) 80%,rgba(194,0,48,.6) 80%,rgba(194,0,48,.6) 90%,rgba(194,0,48,.8) 90%),#da9400;background:linear-gradient(0deg,rgba(194,0,48,0) 10%,rgba(194,0,48,.05) 10%,rgba(194,0,48,.05) 20%,rgba(194,0,48,.1) 20%,rgba(194,0,48,.1) 30%,rgba(194,0,48,.15) 30%,rgba(194,0,48,.15) 40%,rgba(194,0,48,.2) 40%,rgba(194,0,48,.2) 50%,rgba(194,0,48,.3) 50%,rgba(194,0,48,.3) 60%,rgba(194,0,48,.4) 60%,rgba(194,0,48,.4) 70%,rgba(194,0,48,.5) 70%,rgba(194,0,48,.5) 80%,rgba(194,0,48,.6) 80%,rgba(194,0,48,.6) 90%,rgba(194,0,48,.8) 90%),linear-gradient(-90deg,rgba(194,0,48,0) 10%,rgba(194,0,48,.05) 10%,rgba(194,0,48,.05) 20%,rgba(194,0,48,.1) 20%,rgba(194,0,48,.1) 30%,rgba(194,0,48,.15) 30%,rgba(194,0,48,.15) 40%,rgba(194,0,48,.2) 40%,rgba(194,0,48,.2) 50%,rgba(194,0,48,.3) 50%,rgba(194,0,48,.3) 60%,rgba(194,0,48,.4) 60%,rgba(194,0,48,.4) 70%,rgba(194,0,48,.5) 70%,rgba(194,0,48,.5) 80%,rgba(194,0,48,.6) 80%,rgba(194,0,48,.6) 90%,rgba(194,0,48,.8) 90%),#da9400;min-height:100vh}.article--title{font-weight:700;text-shadow:0 -.005em #111,-.005em 0 #282727,-.005em -.01em #111,-.01em -.005em #282727,-.01em -.015em #111,-.015em -.01em #282727,-.015em -.02em #111,-.02em -.015em #282727,-.02em -.025em #111,-.025em -.02em #282727,-.025em -.03em #111,-.03em -.025em #282727,-.03em -.035em #111,-.035em -.03em #282727,-.035em -.04em #111,-.04em -.035em #282727,-.04em -.045em #111,-.045em -.04em #282727,-.045em -.05em #111,-.05em -.045em #282727,-.05em -.055em #111,-.055em -.05em #282727,-.055em -.06em #111,-.06em -.055em #282727,-.06em -.065em #111,-.065em -.06em #282727,-.065em -.07em #111,-.07em -.065em #282727,-.07em -.075em #111,-.075em -.07em #282727;font-size:2.09881em;-webkit-font-feature-settings:"liga","dlig";-ms-font-feature-settings:"liga","dlig";-o-font-feature-settings:"liga","dlig";font-feature-settings:"liga","dlig";line-height:1.2;max-width:100%;margin:0 0 0 auto;text-align:right;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto;color:#f8f7f2}@media (min-width:20em) and (max-width:22em){.article--title{font-size:calc(2.09881em + .38951 * ((100vw - 20em)/ 2))}}@media (min-width:22em) and (max-width:60em){.article--title{font-size:calc(2.48832em + 2.81629 * ((100vw - 22em)/ 38))}}@media (min-width:60em){.article--title{font-size:5.30461em}}@media (min-width:860px){.article--title{max-width:80%;margin-right:calc(10% - 2rem)}}.article--content{margin:0 auto;max-width:760px;padding-top:1.4rem}@media (min-width:448px){.article--content{padding-top:1.618rem}}.video--16-9{position:relative;height:0;padding-top:56.25%;width:100%}.video--16-9>*{display:block;position:absolute;width:100%!important;height:100%!important;top:0;margin:0;padding:0}._blog{margin-top:0}@supports (display:flex){._blog{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}._blog--article{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}}</style> <script id="loadcss">!function(e,n){!function(e){"use strict";var n=function(n,t,o){var l,r=e.document,d=r.createElement("link");if(t)l=t;else{var i=(r.body||r.getElementsByTagName("head")[0]).childNodes;l=i[i.length-1]}var s=r.styleSheets;d.rel="stylesheet",d.href=n,d.media="only x",l.parentNode.insertBefore(d,t?l:l.nextSibling);var a=function(e){for(var n=d.href,t=s.length;t--;)if(s[t].href===n)return e();setTimeout(function(){a(e)})};return d.onloadcssdefined=a,a(function(){d.media=o||"all"}),d};"undefined"!=typeof module?module.exports=n:e.loadCSS=n}("undefined"!=typeof global?global:this);for(var t in e)loadCSS(e[t],n)}(["/css/style.css"],document.getElementById("loadcss"));</script> <noscript> <link rel="stylesheet" href="/css/style.css"> </noscript> <script>!function(){"use strict";var e,t,n,o,s="/css/fonts.css?bust=0312161035";window.domCL=!1,window.addEventListener("DOMContentLoaded",function(){window.domCL=!0}),window.localStorage&&document.querySelector&&window.XMLHttpRequest&&(e=localStorage.getItem("fonts"),o=localStorage.getItem("fontURL"),e&&o===s?(t=document.querySelector('link[rel="stylesheet"]'),n=window.document.createElement("style"),n.innerHTML=e,t.parentNode.insertBefore(n,t.nextSibling)):window.addEventListener("load",function(){t=new XMLHttpRequest,t.open("GET",s),t.onreadystatechange=function(){localStorage.setItem("fonts",t.responseText),localStorage.setItem("fontURL",s)},t.send()}))}();</script> </head> <body> <div class="_blog"> <main class="_blog--article" itemscope itemtype="http://schema.org/Blog"> <article class="article"> <header class="article--heading"> <h1 class="article--title" itemprop="name">Bulletproof Combo Fixed and Fluid Grids with CSS3 Calc</h1> </header> <div class="article--content base" itemprop="text"> <p>You wanna see something cool?</p> <p><div class="video--16-9"><iframe src="//player.vimeo.com/video/84435424" width="560" height="315" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></p> <p>Did you catch that? If not, take a good look at the red and green columns. Notice something different about them? How about something a bit more practical.</p> <p><div class="video--16-9"><iframe src="//player.vimeo.com/video/84435488" width="560" height="315" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></p> <p>See it there? Are you excited yet, because I know I am!</p> <p>Yesterday morning I had a bit of a brainstorm. Working on a new project, I was asked by a designer who didn’t have any responsive web design experience if he could have a fixed width sidebar and a fluid, flexible column to fill the rest of the space. I told him he’d need to wait until <a href="http://www.w3.org/TR/css3-flexbox/">flexbox</a> in order to have it; he didn’t understand what that meant. I though in the back of my mind “well, maybe with <a href="http://www.w3.org/TR/css3-values/#calc">calc</a> you could pull something off”, but I let that though go quickly because, well, it was stupid. Oh but how the unconscious works! I was awoken yesterday morning at 5am to my brain yelling at me “SAM! YOU’VE ALREADY DONE ALL OF THE MATH! JUST PRINT IT OUT AS A STRING!” To which, I replied “Brain, shut up. It’s too early to mess with calc for the first time.” My brain didn’t listen. After taking a quick trip to <a href="http://caniuse.com/calc">Can I Use</a>, I was amazed by the fact that, for the most part (and certainly for this project’s support level), not only could I reliably use <code>calc</code>, but I could use it unprefixed! After reading that, my brain wouldn’t let me go back to sleep.</p> <p>In order to get the calculations right, I had to do a bit of math. I like math, but this was annoying math because the only way I’m able to check the results is by rendering everything in browser; no way to check my work as I went. With a bit of work, I came up with the following (somewhat) simple formula for determining the width of a single fluid item in a mixed fixed/fluid column pattern:</p> <pre><code class="language-bash">((100% - (sum of fixed widths + sum of gutter widths)) / (sum of fluid width)) * (fluid column width)
</code></pre> <p>It’s fairly straight forward; take the whole width, subtract the fixed parts, divide into equal sized columns, multiply by column width. Sure, fair enough. But then, what happens if you want to span multiple fluid columns? Well you get a formula that looks something like this:</p> <pre><code class="language-bash">(((100% - (sum of fixed widths + sum of gutter widths)) / (sum of fluid width)) * (fluid column width) + (gutter width)) + (((100% - (sum of fixed widths + sum of column widths)) / (sum of fluid width)) * (fluid column width))
</code></pre> <p>Fair enough, math, it’s complex. Did I mention yet that that’s the <em>string</em> that needs to get printed out? What about a mixture of fixed and fluid columns?</p> <pre><code class="language-bash">(((100% - (sum of fixed widths + sum of gutter widths)) / (sum of fluid width)) * (fluid column width) + (gutter width)) + (fixed width + gutter width) + (((100% - (sum of fixed widths + sum of column widths)) / (sum of fluid width)) * (fluid column width))
</code></pre> <p>Okay, that’s getting unwieldy. But it’s not over! We want to be able to use <a href="https://github.com/Team-Sass/Singularity/wiki/Output-Styles#isolation">isolation</a> output’s source order independent ordering, so we need to calculate margins too! Simple enough, the width of each column preceding the one we’re on plus a gutter a piece, but remember the formula for fluid width items! To give you an idea of what that’d look like (and it’s calculated width), here’s the margin property for the blue item in the first video (the initial <code>0.5em</code> is because we’re using <a href="https://github.com/Team-Sass/Singularity/wiki/Creating-Grids#split-gutters">split gutters</a>).</p> <pre><code class="language-scss">.third {
  width: calc((((100% - (520px + 5em)) / (4))) * 2);
  margin-left: calc(0.5em + (320px + 1em) + (((100% - (520px + 5em)) / (4)) * 1 + 1em));
}
</code></pre> <p>Yah, long story short, this is stupid and you shouldn’t ever use this method; at least not without a CSS Preprocessor</p> <h2 id="enter-sass">Enter Sass</h2> <p>I love <a href="https://github.com/Team-Sass/Singularity/">Singularity</a> and I’m really proud of 1.2.0’s output plugin system. Scott and I have always envisioned Singularity as a base API for working with grids, something that can be extended in ways unimaginable. So, I decided to write an Output Plugin for Singularity called <code>calc</code>. Because we’re not ready to support it fully yet, it’s living in <a href="https://github.com/Team-Sass/Singularity-extras">Singularity Extras</a> now as of version 1.0.0.alpha.1. Using it is easy, just download (either add that version to your Gemfile, or <a href="https://github.com/Team-Sass/Singularity-extras/releases/tag/1.0.0.alpha.1">download the files directly to your project</a>) and import <code>singularity-extras/outputs</code>. Then, you’re ready to use!</p> <p><code>calc</code> grids are some restrictions placed on them that <code>float</code> and <code>isolation</code> grids don’t. First, they must be asymmetric grids, meaning you must define the width of each column. You can mix any units you want as long as they are compatible with <code>calc</code> (as of this writing, for instance, <code>rem</code> units aren’t for some reason). If you want to define parts of the remaining fluid area, you do so with unit less numbers just like you would when normally using Singularity. The other change is that <code>calc</code> grids only work with fixed width gutters (gutters with defined units, including <code>%</code> if you so choose) as the alternative would be having the gutter widths being defined by the remaining fluid area, which is quite hard to grok and doesn’t make much sense to me. Mix units all you want, <code>calc</code> will take care of it (at least in all of my tests). Otherwise, <code>calc</code> behaves more or less identical to <code>isolation</code>. To give you an idea of what this looks like, here’s the grid definition for the first video:</p> <pre><code class="language-scss">@import &quot;breakpoint&quot;;
@import &quot;singularitygs&quot;;
@import &quot;singularity-extras/outputs&quot;;

@include add-grid(320px 1 2 200px 1);
@include add-gutter(1em);
@include add-gutter-style(&#39;split&#39;);
@include sgs-change(&#39;output&#39;, &#39;calc&#39;);
</code></pre> <p>Here’s the HTML and the Sass for the second video:</p> <pre><code class="language-markup">&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Test&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;css/test.css&quot;&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class=&quot;main&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;primary-sidebar&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;secondary-sidebar&quot;&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre> <pre><code class="language-scss">@import &quot;breakpoint&quot;;
@import &quot;singularitygs&quot;;
@import &quot;singularity-extras/generators/ratio&quot;;
@import &quot;singularity-extras/generators/snap&quot;;
@import &quot;singularity-extras/outputs&quot;;

@include add-grid(400px 1 300px);
@include add-gutter(1em);
@include sgs-change(&#39;output&#39;, &#39;calc&#39;);

.main {
  background: red;
  @include grid-span(1, 2);
}

.primary-sidebar {
  background: green;
  @include grid-span(1, 1);
}

.secondary-sidebar {
  background: blue;
  @include grid-span(1, 3);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
}

div {
  height: 100vh;
  margin: 0;
  padding: 0;
}
</code></pre> <p>I hope you enjoy doing some awesome and crazy things with this. Enjoy!</p> </div> <footer class="article--author"> <span class="article--published" itemprop="datePublished">Published on <time datetime="2016-03-12">January 17th, 2014</time></span> </footer> </article> </main> <footer class="_blog--footer"> <div class="footer"> <ul class="footer--links"> <li class="footer--link-item"> <a href="/" class="footer--link">Home</a> </li> <li class="footer--link-item"> <a href="/me" class="footer--link">Me</a> </li> <li class="footer--link-item"> <a href="/presentations" class="footer--link">Presentations</a> </li> <li class="footer--link-item"> <a href="/musings" class="footer--link">Musings</a> </li> </ul> </div> </footer> </div> <script src="/js/app.js" async defer></script> <script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-30577396-1","auto"),ga("send","pageview");</script> </body> </html> 